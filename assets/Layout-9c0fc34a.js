import{b as u,m}from"./vendor-9a0f791b.js";import{n as f}from"./index-be2a32b1.js";import"./antd-9845fd40.js";const _={name:"Layout",data(){return{collapsed:!1,selectedKeys:[],openKeys:[]}},computed:{...u("user",["userAvatar","userName"]),menuRoutes(){return this.$router.options.routes.filter(s=>s.path!=="/login"&&s.path!=="/")}},watch:{$route:{handler(s){this.updateSelectedKeys(s)},immediate:!0}},methods:{...m("auth",["logout"]),toggleCollapsed(){this.collapsed=!this.collapsed},handleMenuClick({key:s}){this.$route.path!==s&&this.$router.push(s)},handleOpenChange(s){this.openKeys=s},updateSelectedKeys(s){const e=s.path;let t=null,a=null;for(const l of this.menuRoutes)if(l.children&&l.children.length>0){for(const n of l.children){let i=n.path;if(n.path.startsWith("/")||(i=l.path+"/"+n.path),i===e){t=n.path,a=l.path;break}}if(t)break;if(e===l.path){const n=l.children.find(i=>{var o;return!((o=i.meta)!=null&&o.hidden)});if(n){t=n.path,a=l.path;break}}}else if(l.path===e){t=l.path;break}t||(t=e),this.selectedKeys=[t],a?this.openKeys=[a]:this.openKeys=[]},getRouteIcon(s){var e;return((e=s.meta)==null?void 0:e.icon)||"file"},getVisibleChildren(s){return s.children?s.children.filter(e=>{var t;return!((t=e.meta)!=null&&t.hidden)}):[]},async handleLogout(){try{await this.logout(),this.$message.success("退出成功"),this.$router.push("/login")}catch{this.$message.error("退出失败")}}}};var y=function(){var e=this,t=e._self._c;return t("a-layout",{staticClass:"layout"},[t("a-layout-sider",{staticClass:"sidebar",attrs:{trigger:null,collapsible:""},model:{value:e.collapsed,callback:function(a){e.collapsed=a},expression:"collapsed"}},[t("div",{staticClass:"logo"},[e.collapsed?t("h2",[e._v("AI")]):t("h2",[e._v("AI提示词管理")])]),t("a-menu",{attrs:{theme:"dark",mode:"inline",selectedKeys:e.selectedKeys,openKeys:e.openKeys},on:{click:e.handleMenuClick,openChange:e.handleOpenChange}},[e._l(e.menuRoutes,function(a){var l,n,i,o,c,h;return[a.children&&e.getVisibleChildren(a).length>1?t("a-sub-menu",{key:a.path},[t("span",{attrs:{slot:"title"},slot:"title"},[t("a-icon",{attrs:{type:((l=a.meta)==null?void 0:l.icon)||"file"}}),t("span",[e._v(e._s(((n=a.meta)==null?void 0:n.title)||"未命名"))])],1),e._l(a.children,function(r){var d,p;return(d=r.meta)!=null&&d.hidden?e._e():t("a-menu-item",{key:r.path},[t("a-icon",{attrs:{type:e.getRouteIcon(r)}}),t("span",[e._v(e._s(((p=r.meta)==null?void 0:p.title)||"未命名"))])],1)})],2):e._e(),a.children&&e.getVisibleChildren(a).length===1?t("a-menu-item",{key:e.getVisibleChildren(a)[0].path},[t("a-icon",{attrs:{type:((i=e.getVisibleChildren(a)[0].meta)==null?void 0:i.icon)||((o=a.meta)==null?void 0:o.icon)||"file"}}),t("span",[e._v(e._s(((c=e.getVisibleChildren(a)[0].meta)==null?void 0:c.title)||((h=a.meta)==null?void 0:h.title)||"未命名"))])],1):e._e()]})],2)],1),t("a-layout",[t("a-layout-header",{staticClass:"header"},[t("a-icon",{staticClass:"trigger",attrs:{type:e.collapsed?"menu-unfold":"menu-fold"},on:{click:e.toggleCollapsed}}),t("div",{staticClass:"header-right"},[t("a-dropdown",[t("a",{staticClass:"user-dropdown"},[t("a-avatar",{attrs:{src:e.userAvatar}}),t("span",{staticClass:"username"},[e._v(e._s(e.userName))]),t("a-icon",{attrs:{type:"down"}})],1),t("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[t("a-menu-item",{on:{click:e.handleLogout}},[t("a-icon",{attrs:{type:"logout"}}),e._v(" 退出登录 ")],1)],1)],1)],1)],1),t("a-layout-content",{staticClass:"content"},[t("router-view")],1)],1)],1)},g=[],C=f(_,y,g,!1,null,"6c76f48b",null,null);const k=C.exports;export{k as default};
