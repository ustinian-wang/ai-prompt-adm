import{b as l,m as n}from"./vendor-9a0f791b.js";import{n as c}from"./index-be2a32b1.js";import"./antd-9845fd40.js";const u={name:"UserList",data(){return{modalVisible:!1,isEdit:!1,submitLoading:!1,userForm:{username:"",email:"",role:"",status:"active",password:""},userRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},computed:{...l("user",["usersList","loading","pagination"]),columns(){return[{title:"头像",dataIndex:"avatar",key:"avatar",width:80,scopedSlots:{customRender:"avatar"}},{title:"用户名",dataIndex:"username",key:"username",width:120,scopedSlots:{customRender:"username"}},{title:"邮箱",dataIndex:"email",key:"email",width:200},{title:"角色",dataIndex:"role",key:"role",width:120,scopedSlots:{customRender:"role"}},{title:"状态",dataIndex:"status",key:"status",width:100,scopedSlots:{customRender:"status"}},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:150},{title:"最后登录",dataIndex:"lastLogin",key:"lastLogin",width:150,scopedSlots:{customRender:"lastLogin"}},{title:"操作",key:"action",width:150,scopedSlots:{customRender:"action"}}]}},mounted(){this.getUsersList()},methods:{...n("user",["getUsersList","createUser","updateUser","deleteUser"]),getStatusColor(a){return{active:"#52c41a",inactive:"#d9d9d9",suspended:"#faad14"}[a]||"#d9d9d9"},getStatusText(a){return{active:"活跃",inactive:"非活跃",suspended:"已暂停"}[a]||"未知"},getStatusIcon(a){return{active:"check-circle",inactive:"close-circle",suspended:"pause-circle"}[a]||"question"},getRoleColor(a){return{超级管理员:"#1890ff",内容管理员:"#faad14",用户管理员:"#52c41a",普通用户:"#722ed1",访客:"#f5222d"}[a]||"#d9d9d9"},formatDate(a){if(!a)return"N/A";const e=new Date(a),t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return`${t}-${s}-${r} ${o}:${i}`},showCreateModal(){this.isEdit=!1,this.userForm={username:"",email:"",role:"",status:"active",password:""},this.modalVisible=!0},editUser(a){this.isEdit=!0,this.userForm={id:a.id,username:a.username,email:a.email,role:a.role,status:a.status},this.modalVisible=!0},async handleSubmit(){try{await this.$refs.userForm.validate(),this.submitLoading=!0,this.isEdit?(await this.updateUser(this.userForm),this.$message.success("更新用户成功")):(await this.createUser(this.userForm),this.$message.success("创建用户成功")),this.modalVisible=!1,this.getUsersList()}catch(a){console.error("提交失败:",a)}finally{this.submitLoading=!1}},handleCancel(){this.modalVisible=!1,this.$refs.userForm.resetFields()},async deleteUser(a){try{await this.deleteUser(a),this.$message.success("删除用户成功"),this.getUsersList()}catch{this.$message.error("删除失败")}},handleSearch(){this.getUsersList({username:this.searchForm.getFieldValue("username"),email:this.searchForm.getFieldValue("email"),role:this.searchForm.getFieldValue("role"),status:this.searchForm.getFieldValue("status")})},handleReset(){this.searchForm.resetFields(),this.getUsersList()},handleExport(){this.$message.info("导出功能待实现")},viewUser(a){this.$message.info(`查看用户 ${a.username} 详情`)},resetPassword(a){this.$message.info(`重置用户 ${a} 的密码`)},toggleUserStatus(a){this.$message.info(`切换用户 ${a.username} 状态为 ${a.status==="active"?"非活跃":"活跃"}`)},assignRole(a){this.$message.info(`分配角色给用户 ${a.username}`)}}};var m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-list"},[t("div",{staticClass:"page-header"},[e._m(0),t("a-button",{attrs:{type:"primary",size:"large"},on:{click:e.showCreateModal}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 新建用户 ")],1)],1),t("div",{staticClass:"content-wrapper"},[t("a-card",{staticClass:"search-card",attrs:{bordered:!1}},[t("a-form",{attrs:{layout:"inline",form:e.searchForm}},[t("a-row",{staticStyle:{width:"100%"},attrs:{gutter:16}},[t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"用户名"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username"],expression:"['username']"}],attrs:{placeholder:"请输入用户名","allow-clear":"",size:"large"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"邮箱"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email"],expression:"['email']"}],attrs:{placeholder:"请输入邮箱","allow-clear":"",size:"large"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"角色"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["role"],expression:"['role']"}],attrs:{placeholder:"请选择角色","allow-clear":"",size:"large"}},[t("a-select-option",{attrs:{value:"超级管理员"}},[e._v("超级管理员")]),t("a-select-option",{attrs:{value:"内容管理员"}},[e._v("内容管理员")]),t("a-select-option",{attrs:{value:"用户管理员"}},[e._v("用户管理员")]),t("a-select-option",{attrs:{value:"普通用户"}},[e._v("普通用户")]),t("a-select-option",{attrs:{value:"访客"}},[e._v("访客")])],1)],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"状态"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status"],expression:"['status']"}],attrs:{placeholder:"请选择状态","allow-clear":"",size:"large"}},[t("a-select-option",{attrs:{value:"active"}},[e._v("活跃")]),t("a-select-option",{attrs:{value:"inactive"}},[e._v("非活跃")]),t("a-select-option",{attrs:{value:"suspended"}},[e._v("已暂停")])],1)],1)],1)],1),t("a-row",{staticStyle:{"margin-top":"16px"},attrs:{gutter:16}},[t("a-col",{attrs:{span:24}},[t("a-form-item",[t("a-button",{attrs:{type:"primary",size:"large"},on:{click:e.handleSearch}},[t("a-icon",{attrs:{type:"search"}}),e._v(" 搜索 ")],1),t("a-button",{staticStyle:{"margin-left":"8px"},attrs:{size:"large"},on:{click:e.handleReset}},[t("a-icon",{attrs:{type:"reload"}}),e._v(" 重置 ")],1),t("a-button",{staticStyle:{"margin-left":"8px"},attrs:{size:"large"},on:{click:e.handleExport}},[t("a-icon",{attrs:{type:"download"}}),e._v(" 导出 ")],1)],1)],1)],1)],1)],1),t("a-card",{staticClass:"table-card",attrs:{bordered:!1}},[t("a-table",{attrs:{columns:e.columns,"data-source":e.usersList,loading:e.loading,pagination:e.pagination,"row-key":"id",size:"middle"},scopedSlots:e._u([{key:"avatar",fn:function(s,r){return[t("div",{staticClass:"user-avatar"},[t("a-avatar",{attrs:{src:s,size:40}},[e._v(" "+e._s(r.username?r.username.charAt(0).toUpperCase():"U")+" ")])],1)]}},{key:"username",fn:function(s,r){return[t("div",{staticClass:"user-info"},[t("div",{staticClass:"username"},[e._v(e._s(s))]),t("div",{staticClass:"user-id"},[e._v("ID: "+e._s(r.id))])])]}},{key:"role",fn:function(s){return[t("a-tag",{attrs:{color:e.getRoleColor(s)}},[e._v(e._s(s))])]}},{key:"status",fn:function(s){return[t("a-tag",{attrs:{color:e.getStatusColor(s)}},[t("a-icon",{attrs:{type:e.getStatusIcon(s)}}),e._v(" "+e._s(e.getStatusText(s))+" ")],1)]}},{key:"lastLogin",fn:function(s){return[t("span",{staticClass:"last-login"},[e._v(e._s(e.formatDate(s)))])]}},{key:"action",fn:function(s,r){return[t("div",{staticClass:"action-buttons"},[t("a-button",{staticClass:"action-btn",attrs:{type:"link"},on:{click:function(o){return e.editUser(r)}}},[t("a-icon",{attrs:{type:"edit"}}),e._v(" 编辑 ")],1),t("a-button",{staticClass:"action-btn",attrs:{type:"link"},on:{click:function(o){return e.viewUser(r)}}},[t("a-icon",{attrs:{type:"eye"}}),e._v(" 查看 ")],1),t("a-dropdown",[t("a-button",{staticClass:"action-btn",attrs:{type:"link"}},[t("a-icon",{attrs:{type:"more"}}),e._v(" 更多 ")],1),t("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[t("a-menu-item",{on:{click:function(o){return e.resetPassword(r.id)}}},[t("a-icon",{attrs:{type:"key"}}),e._v(" 重置密码 ")],1),t("a-menu-item",{on:{click:function(o){return e.toggleUserStatus(r)}}},[t("a-icon",{attrs:{type:r.status==="active"?"pause-circle":"play-circle"}}),e._v(" "+e._s(r.status==="active"?"暂停用户":"启用用户")+" ")],1),t("a-menu-item",{on:{click:function(o){return e.assignRole(r)}}},[t("a-icon",{attrs:{type:"team"}}),e._v(" 分配角色 ")],1)],1)],1),t("a-popconfirm",{attrs:{title:"确定要删除这个用户吗？","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(o){return e.deleteUser(r.id)}}},[t("a-button",{staticClass:"action-btn delete-btn",attrs:{type:"link"}},[t("a-icon",{attrs:{type:"delete"}}),e._v(" 删除 ")],1)],1)],1)]}}])})],1)],1),t("a-modal",{staticClass:"user-modal",attrs:{title:e.isEdit?"编辑用户":"新建用户",visible:e.modalVisible,"confirm-loading":e.submitLoading,width:600},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-form-model",{ref:"userForm",attrs:{model:e.userForm,rules:e.userRules,"label-col":{span:6},"wrapper-col":{span:18},layout:"horizontal"}},[t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"用户名",prop:"username"}},[t("a-input",{attrs:{placeholder:"请输入用户名",size:"large"},model:{value:e.userForm.username,callback:function(s){e.$set(e.userForm,"username",s)},expression:"userForm.username"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"邮箱",prop:"email"}},[t("a-input",{attrs:{placeholder:"请输入邮箱",size:"large"},model:{value:e.userForm.email,callback:function(s){e.$set(e.userForm,"email",s)},expression:"userForm.email"}})],1)],1)],1),t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"真实姓名",prop:"realName"}},[t("a-input",{attrs:{placeholder:"请输入真实姓名",size:"large"},model:{value:e.userForm.realName,callback:function(s){e.$set(e.userForm,"realName",s)},expression:"userForm.realName"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"手机号码",prop:"phone"}},[t("a-input",{attrs:{placeholder:"请输入手机号码",size:"large"},model:{value:e.userForm.phone,callback:function(s){e.$set(e.userForm,"phone",s)},expression:"userForm.phone"}})],1)],1)],1),t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"角色",prop:"role"}},[t("a-select",{attrs:{placeholder:"请选择角色",size:"large"},model:{value:e.userForm.role,callback:function(s){e.$set(e.userForm,"role",s)},expression:"userForm.role"}},[t("a-select-option",{attrs:{value:"超级管理员"}},[e._v("超级管理员")]),t("a-select-option",{attrs:{value:"内容管理员"}},[e._v("内容管理员")]),t("a-select-option",{attrs:{value:"用户管理员"}},[e._v("用户管理员")]),t("a-select-option",{attrs:{value:"普通用户"}},[e._v("普通用户")]),t("a-select-option",{attrs:{value:"访客"}},[e._v("访客")])],1)],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"状态",prop:"status"}},[t("a-select",{attrs:{placeholder:"请选择状态",size:"large"},model:{value:e.userForm.status,callback:function(s){e.$set(e.userForm,"status",s)},expression:"userForm.status"}},[t("a-select-option",{attrs:{value:"active"}},[e._v("活跃")]),t("a-select-option",{attrs:{value:"inactive"}},[e._v("非活跃")]),t("a-select-option",{attrs:{value:"suspended"}},[e._v("已暂停")])],1)],1)],1)],1),e.isEdit?e._e():t("a-form-model-item",{attrs:{label:"密码",prop:"password"}},[t("a-input-password",{attrs:{placeholder:"请输入密码",size:"large"},model:{value:e.userForm.password,callback:function(s){e.$set(e.userForm,"password",s)},expression:"userForm.password"}})],1),t("a-form-model-item",{attrs:{label:"备注",prop:"remark"}},[t("a-textarea",{attrs:{rows:3,placeholder:"请输入备注信息",size:"large"},model:{value:e.userForm.remark,callback:function(s){e.$set(e.userForm,"remark",s)},expression:"userForm.remark"}})],1)],1)],1)],1)},d=[function(){var a=this,e=a._self._c;return e("div",{staticClass:"header-content"},[e("h1",[a._v("用户管理")]),e("p",[a._v("管理系统用户和权限分配")])])}],p=c(u,m,d,!1,null,"58181bb5",null,null);const f=p.exports;export{f as default};
