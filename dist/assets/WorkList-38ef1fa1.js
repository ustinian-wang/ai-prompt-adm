import{b as i,m as l}from"./vendor-9a0f791b.js";import{n}from"./index-bea0c6d7.js";import"./antd-da94fbad.js";const c={name:"WorkList",data(){return{modalVisible:!1,isEdit:!1,submitLoading:!1,searchForm:{workName:"",workType:""},workForm:{workName:"",workType:"",description:"",tags:[],image:""},workRules:{workName:[{required:!0,message:"请输入作品名称",trigger:"blur"}],workType:[{required:!0,message:"请选择作品类型",trigger:"change"}],description:[{required:!0,message:"请输入作品描述",trigger:"blur"}]}}},computed:{...i("works",["worksList","loading","pagination"]),columns(){return[{title:"图片",dataIndex:"image",key:"image",width:80,scopedSlots:{customRender:"image"}},{title:"作品名称",dataIndex:"workName",key:"workName",width:200},{title:"类型",dataIndex:"workType",key:"workType",width:120},{title:"标签",dataIndex:"tags",key:"tags",width:200,scopedSlots:{customRender:"tags"}},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:180},{title:"状态",dataIndex:"status",key:"status",width:100,scopedSlots:{customRender:"status"}},{title:"操作",key:"action",width:200,scopedSlots:{customRender:"action"}}]}},mounted(){this.getWorksList()},methods:{...l("works",["getWorksList","createWork","updateWork","deleteWork"]),handleSearch(){this.getWorksList(this.searchForm)},handleReset(){this.searchForm={workName:"",workType:""},this.getWorksList()},showCreateModal(){this.isEdit=!1,this.workForm={workName:"",workType:"",description:"",tags:[],image:""},this.modalVisible=!0},editWork(a){this.isEdit=!0,this.workForm={id:a.id,workName:a.workName,workType:a.workType,description:a.description,tags:[...a.tags],image:a.image},this.modalVisible=!0},async toggleStatus(a){try{const e=a.status==="展示"?"隐藏":"展示";await this.updateWork({...a,status:e}),this.$message.success(`状态已${e==="展示"?"展示":"隐藏"}`),this.getWorksList()}catch{this.$message.error("状态更新失败")}},async deleteWork(a){try{await this.deleteWork(a),this.$message.success("删除作品成功"),this.getWorksList()}catch{this.$message.error("删除失败")}},async handleSubmit(){try{await this.$refs.workForm.validate(),this.submitLoading=!0,this.isEdit?(await this.updateWork(this.workForm),this.$message.success("更新作品成功")):(await this.createWork(this.workForm),this.$message.success("创建作品成功")),this.modalVisible=!1,this.getWorksList()}catch(a){console.error("提交失败:",a)}finally{this.submitLoading=!1}},handleCancel(){this.modalVisible=!1,this.$refs.workForm.resetFields()},beforeUpload(a){const e=a.type==="image/jpeg"||a.type==="image/png";e||this.$message.error("只能上传 JPG/PNG 格式的图片!");const t=a.size/1024/1024<2;return t||this.$message.error("图片大小不能超过 2MB!"),e&&t},handleImageChange(a){a.file.status==="done"&&(this.workForm.image=a.file.response.url||URL.createObjectURL(a.file.originFileObj))}}};var m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"work-list"},[t("div",{staticClass:"breadcrumb-section"},[t("a-breadcrumb",[t("a-breadcrumb-item",[e._v("首页")]),t("a-breadcrumb-item",[e._v("作品管理")]),t("a-breadcrumb-item",[e._v("作品列表")])],1)],1),e._m(0),t("div",{staticClass:"search-section"},[t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:6}},[t("a-input",{attrs:{placeholder:"作品名称","allow-clear":""},model:{value:e.searchForm.workName,callback:function(s){e.$set(e.searchForm,"workName",s)},expression:"searchForm.workName"}})],1),t("a-col",{attrs:{span:6}},[t("a-select",{attrs:{placeholder:"选择类型","allow-clear":""},model:{value:e.searchForm.workType,callback:function(s){e.$set(e.searchForm,"workType",s)},expression:"searchForm.workType"}},[t("a-select-option",{attrs:{value:"UI设计"}},[e._v("UI设计")]),t("a-select-option",{attrs:{value:"3D设计"}},[e._v("3D设计")]),t("a-select-option",{attrs:{value:"图标设计"}},[e._v("图标设计")]),t("a-select-option",{attrs:{value:"插画设计"}},[e._v("插画设计")])],1)],1),t("a-col",{attrs:{span:6}},[t("a-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[t("a-icon",{attrs:{type:"search"}}),e._v(" 搜索 ")],1),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.handleReset}},[e._v(" 重置 ")])],1)],1)],1),t("div",{staticClass:"action-section"},[t("a-button",{attrs:{type:"primary"},on:{click:e.showCreateModal}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 新增 ")],1)],1),t("div",{staticClass:"table-section"},[t("a-table",{attrs:{columns:e.columns,"data-source":e.worksList,loading:e.loading,pagination:e.pagination,"row-key":"id",size:"middle"},scopedSlots:e._u([{key:"image",fn:function(s){return[t("div",{staticClass:"work-image"},[s.image?t("img",{staticClass:"work-thumbnail",attrs:{src:s.image,alt:s.workName}}):t("div",{staticClass:"image-placeholder"},[t("a-icon",{attrs:{type:"picture"}})],1)])]}},{key:"tags",fn:function(s){return[t("div",{staticClass:"work-tags"},e._l(s,function(r){return t("a-tag",{key:r,attrs:{color:"blue"}},[e._v(" "+e._s(r)+" ")])}),1)]}},{key:"status",fn:function(s){return[t("a-tag",{attrs:{color:s==="展示"?"green":"default"}},[e._v(" "+e._s(s)+" ")])]}},{key:"action",fn:function(s,r){return[t("a-space",[t("a-button",{attrs:{type:"link",size:"small"},on:{click:function(o){return e.editWork(r)}}},[e._v(" 编辑 ")]),t("a-button",{attrs:{type:"link",size:"small"},on:{click:function(o){return e.toggleStatus(r)}}},[e._v(" "+e._s(r.status==="展示"?"隐藏":"展示")+" ")]),t("a-popconfirm",{attrs:{title:"确定要删除这个作品吗？"},on:{confirm:function(o){return e.deleteWork(r.id)}}},[t("a-button",{staticStyle:{color:"#ff4d4f"},attrs:{type:"link",size:"small"}},[e._v(" 删除 ")])],1)],1)]}}])})],1),t("a-modal",{attrs:{title:e.isEdit?"编辑作品":"新增作品",visible:e.modalVisible,"confirm-loading":e.submitLoading,width:"600px"},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-form-model",{ref:"workForm",attrs:{model:e.workForm,rules:e.workRules,"label-col":{span:6},"wrapper-col":{span:16}}},[t("a-form-model-item",{attrs:{label:"作品名称",prop:"workName"}},[t("a-input",{attrs:{placeholder:"请输入作品名称"},model:{value:e.workForm.workName,callback:function(s){e.$set(e.workForm,"workName",s)},expression:"workForm.workName"}})],1),t("a-form-model-item",{attrs:{label:"作品类型",prop:"workType"}},[t("a-select",{attrs:{placeholder:"请选择作品类型"},model:{value:e.workForm.workType,callback:function(s){e.$set(e.workForm,"workType",s)},expression:"workForm.workType"}},[t("a-select-option",{attrs:{value:"UI设计"}},[e._v("UI设计")]),t("a-select-option",{attrs:{value:"3D设计"}},[e._v("3D设计")]),t("a-select-option",{attrs:{value:"图标设计"}},[e._v("图标设计")]),t("a-select-option",{attrs:{value:"插画设计"}},[e._v("插画设计")])],1)],1),t("a-form-model-item",{attrs:{label:"作品描述",prop:"description"}},[t("a-textarea",{attrs:{rows:4,placeholder:"请输入作品描述"},model:{value:e.workForm.description,callback:function(s){e.$set(e.workForm,"description",s)},expression:"workForm.description"}})],1),t("a-form-model-item",{attrs:{label:"作品标签"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{mode:"tags",placeholder:"请输入标签，按回车确认"},model:{value:e.workForm.tags,callback:function(s){e.$set(e.workForm,"tags",s)},expression:"workForm.tags"}})],1),t("a-form-model-item",{attrs:{label:"作品图片"}},[t("a-upload",{staticClass:"work-uploader",attrs:{name:"file","list-type":"picture-card","show-upload-list":!1,"before-upload":e.beforeUpload},on:{change:e.handleImageChange}},[e.workForm.image?t("img",{attrs:{src:e.workForm.image,alt:"作品图片"}}):t("div",[t("a-icon",{attrs:{type:"plus"}}),t("div",{staticClass:"ant-upload-text"},[e._v("上传图片")])],1)])],1)],1)],1)],1)},d=[function(){var a=this,e=a._self._c;return e("div",{staticClass:"page-header"},[e("h1",[a._v("作品发布")])])}],u=n(c,m,d,!1,null,"49ae8efe",null,null);const g=u.exports;export{g as default};
