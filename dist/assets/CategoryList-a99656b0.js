import{b as i,m as n}from"./vendor-9a0f791b.js";import{n as l}from"./index-7809c99c.js";import"./antd-9085d354.js";const c={name:"CategoryList",data(){return{modalVisible:!1,isEdit:!1,submitLoading:!1,categoryForm:{name:"",description:"",sortOrder:1},categoryRules:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}],description:[{required:!0,message:"请输入分类描述",trigger:"blur"}],sortOrder:[{required:!0,message:"请输入排序值",trigger:"change"}]}}},computed:{...i("categories",["categoriesList","loading"]),columns(){return[{title:"分类名称",dataIndex:"name",key:"name",width:150},{title:"描述",dataIndex:"description",key:"description",ellipsis:!0},{title:"排序",dataIndex:"sortOrder",key:"sortOrder",width:80},{title:"作品数量",dataIndex:"count",key:"count",width:100,scopedSlots:{customRender:"count"}},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:150},{title:"操作",key:"action",width:150,scopedSlots:{customRender:"action"}}]}},mounted(){this.getCategoriesList()},methods:{...n("categories",["getCategoriesList","createCategory","updateCategory","deleteCategory"]),showCreateModal(){this.isEdit=!1,this.categoryForm={name:"",description:"",sortOrder:1},this.modalVisible=!0},editCategory(r){this.isEdit=!0,this.categoryForm={id:r.id,name:r.name,description:r.description,sortOrder:r.sortOrder},this.modalVisible=!0},async handleSubmit(){try{await this.$refs.categoryForm.validate(),this.submitLoading=!0,this.isEdit?(await this.updateCategory(this.categoryForm),this.$message.success("更新分类成功")):(await this.createCategory(this.categoryForm),this.$message.success("创建分类成功")),this.modalVisible=!1,this.getCategoriesList()}catch(r){console.error("提交失败:",r)}finally{this.submitLoading=!1}},handleCancel(){this.modalVisible=!1,this.$refs.categoryForm.resetFields()},async deleteCategory(r){try{await this.deleteCategory(r),this.$message.success("删除分类成功"),this.getCategoriesList()}catch{this.$message.error("删除失败")}}}};var d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"category-list"},[t("div",{staticClass:"page-header"},[t("h2",[e._v("分类管理")]),t("a-button",{attrs:{type:"primary"},on:{click:e.showCreateModal}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 新建分类 ")],1)],1),t("a-table",{attrs:{columns:e.columns,"data-source":e.categoriesList,loading:e.loading,"row-key":"id"},scopedSlots:e._u([{key:"count",fn:function(a){return[t("a-tag",{attrs:{color:"blue"}},[e._v(e._s(a))])]}},{key:"action",fn:function(a,s){return[t("a-button",{attrs:{type:"link"},on:{click:function(o){return e.editCategory(s)}}},[e._v("编辑")]),t("a-popconfirm",{attrs:{title:"确定要删除这个分类吗？"},on:{confirm:function(o){return e.deleteCategory(s.id)}}},[t("a-button",{staticStyle:{color:"#ff4d4f"},attrs:{type:"link"}},[e._v("删除")])],1)]}}])}),t("a-modal",{attrs:{title:e.isEdit?"编辑分类":"新建分类",visible:e.modalVisible,"confirm-loading":e.submitLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-form-model",{ref:"categoryForm",attrs:{model:e.categoryForm,rules:e.categoryRules,"label-col":{span:6},"wrapper-col":{span:16}}},[t("a-form-model-item",{attrs:{label:"分类名称",prop:"name"}},[t("a-input",{attrs:{placeholder:"请输入分类名称"},model:{value:e.categoryForm.name,callback:function(a){e.$set(e.categoryForm,"name",a)},expression:"categoryForm.name"}})],1),t("a-form-model-item",{attrs:{label:"分类描述",prop:"description"}},[t("a-textarea",{attrs:{rows:4,placeholder:"请输入分类描述"},model:{value:e.categoryForm.description,callback:function(a){e.$set(e.categoryForm,"description",a)},expression:"categoryForm.description"}})],1),t("a-form-model-item",{attrs:{label:"排序",prop:"sortOrder"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:100,placeholder:"请输入排序值"},model:{value:e.categoryForm.sortOrder,callback:function(a){e.$set(e.categoryForm,"sortOrder",a)},expression:"categoryForm.sortOrder"}})],1)],1)],1)],1)},m=[],u=l(c,d,m,!1,null,"9038747b",null,null);const h=u.exports;export{h as default};
