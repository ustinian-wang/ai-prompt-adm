import{b as o,m as l}from"./vendor-9a0f791b.js";import{n}from"./index-ba5a40b5.js";import"./antd-9085d354.js";const u={name:"UserList",data(){return{modalVisible:!1,isEdit:!1,submitLoading:!1,userForm:{username:"",email:"",role:"",status:"active",password:""},userRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},computed:{...o("users",["usersList","loading","pagination"]),columns(){return[{title:"头像",dataIndex:"avatar",key:"avatar",width:80,scopedSlots:{customRender:"avatar"}},{title:"用户名",dataIndex:"username",key:"username",width:120},{title:"邮箱",dataIndex:"email",key:"email",width:200},{title:"角色",dataIndex:"role",key:"role",width:120},{title:"状态",dataIndex:"status",key:"status",width:100,scopedSlots:{customRender:"status"}},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:150},{title:"最后登录",dataIndex:"lastLogin",key:"lastLogin",width:150},{title:"操作",key:"action",width:150,scopedSlots:{customRender:"action"}}]}},mounted(){this.getUsersList()},methods:{...l("users",["getUsersList","createUser","updateUser","deleteUser"]),getStatusColor(a){return{active:"#52c41a",inactive:"#d9d9d9"}[a]||"#d9d9d9"},getStatusText(a){return{active:"活跃",inactive:"非活跃"}[a]||"未知"},showCreateModal(){this.isEdit=!1,this.userForm={username:"",email:"",role:"",status:"active",password:""},this.modalVisible=!0},editUser(a){this.isEdit=!0,this.userForm={id:a.id,username:a.username,email:a.email,role:a.role,status:a.status},this.modalVisible=!0},async handleSubmit(){try{await this.$refs.userForm.validate(),this.submitLoading=!0,this.isEdit?(await this.updateUser(this.userForm),this.$message.success("更新用户成功")):(await this.createUser(this.userForm),this.$message.success("创建用户成功")),this.modalVisible=!1,this.getUsersList()}catch(a){console.error("提交失败:",a)}finally{this.submitLoading=!1}},handleCancel(){this.modalVisible=!1,this.$refs.userForm.resetFields()},async deleteUser(a){try{await this.deleteUser(a),this.$message.success("删除用户成功"),this.getUsersList()}catch{this.$message.error("删除失败")}}}};var d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-list"},[t("div",{staticClass:"page-header"},[t("h2",[e._v("用户列表")]),t("a-button",{attrs:{type:"primary"},on:{click:e.showCreateModal}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 新建用户 ")],1)],1),t("a-table",{attrs:{columns:e.columns,"data-source":e.usersList,loading:e.loading,pagination:e.pagination,"row-key":"id"},scopedSlots:e._u([{key:"avatar",fn:function(s){return[t("a-avatar",{attrs:{src:s}})]}},{key:"status",fn:function(s){return[t("a-tag",{attrs:{color:e.getStatusColor(s)}},[e._v(e._s(e.getStatusText(s)))])]}},{key:"action",fn:function(s,r){return[t("a-button",{attrs:{type:"link"},on:{click:function(i){return e.editUser(r)}}},[e._v("编辑")]),t("a-popconfirm",{attrs:{title:"确定要删除这个用户吗？"},on:{confirm:function(i){return e.deleteUser(r.id)}}},[t("a-button",{staticStyle:{color:"#ff4d4f"},attrs:{type:"link"}},[e._v("删除")])],1)]}}])}),t("a-modal",{attrs:{title:e.isEdit?"编辑用户":"新建用户",visible:e.modalVisible,"confirm-loading":e.submitLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-form-model",{ref:"userForm",attrs:{model:e.userForm,rules:e.userRules,"label-col":{span:6},"wrapper-col":{span:16}}},[t("a-form-model-item",{attrs:{label:"用户名",prop:"username"}},[t("a-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.userForm.username,callback:function(s){e.$set(e.userForm,"username",s)},expression:"userForm.username"}})],1),t("a-form-model-item",{attrs:{label:"邮箱",prop:"email"}},[t("a-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.userForm.email,callback:function(s){e.$set(e.userForm,"email",s)},expression:"userForm.email"}})],1),t("a-form-model-item",{attrs:{label:"角色",prop:"role"}},[t("a-select",{attrs:{placeholder:"请选择角色"},model:{value:e.userForm.role,callback:function(s){e.$set(e.userForm,"role",s)},expression:"userForm.role"}},[t("a-select-option",{attrs:{value:"超级管理员"}},[e._v("超级管理员")]),t("a-select-option",{attrs:{value:"内容管理员"}},[e._v("内容管理员")]),t("a-select-option",{attrs:{value:"用户管理员"}},[e._v("用户管理员")]),t("a-select-option",{attrs:{value:"普通用户"}},[e._v("普通用户")]),t("a-select-option",{attrs:{value:"访客"}},[e._v("访客")])],1)],1),t("a-form-model-item",{attrs:{label:"状态",prop:"status"}},[t("a-select",{attrs:{placeholder:"请选择状态"},model:{value:e.userForm.status,callback:function(s){e.$set(e.userForm,"status",s)},expression:"userForm.status"}},[t("a-select-option",{attrs:{value:"active"}},[e._v("活跃")]),t("a-select-option",{attrs:{value:"inactive"}},[e._v("非活跃")])],1)],1),e.isEdit?e._e():t("a-form-model-item",{attrs:{label:"密码",prop:"password"}},[t("a-input-password",{attrs:{placeholder:"请输入密码"},model:{value:e.userForm.password,callback:function(s){e.$set(e.userForm,"password",s)},expression:"userForm.password"}})],1)],1)],1)],1)},m=[],c=n(u,d,m,!1,null,"615b95e8",null,null);const g=c.exports;export{g as default};
